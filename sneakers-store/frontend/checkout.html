<script
  async
  crossorigin="anonymous"
  data-clerk-publishable-key="pk_test_Y3Jpc3Ata29pLTM4LmNsZXJrLmFjY291bnRzLmRldiQ"
  src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest"
></script>

<script>
  window.addEventListener("DOMContentLoaded", async () => {
    await window.Clerk.load();

    // Redirect if user not signed in
    if (!Clerk.user) {
      alert("Please sign in first to continue checkout.");
      window.location.href = "index.html";
      return;
    }

    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const checkoutContainer = document.getElementById("checkout-container");

    if (cart.length === 0) {
      checkoutContainer.innerHTML = `<p>Your cart is empty.</p>`;
      return;
    }

    let total = 0;
    checkoutContainer.innerHTML = cart.map(p => {
      total += p.price;
      return `
        <div class="checkout-item">
          <img src="${p.image}" alt="${p.name}">
          <div>
            <h3>${p.name}</h3>
            <p>â‚¹${p.price}</p>
          </div>
        </div>
      `;
    }).join('');

    checkoutContainer.innerHTML += `
      <h2>Total: â‚¹${total}</h2>
      <button onclick="placeOrder()">Place Order</button>
    `;

    window.placeOrder = () => {
      alert("Order placed successfully! ðŸŽ‰");
      localStorage.removeItem("cart");
      window.location.href = "index.html";
    };
  });
</script>
