<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Checkout - Old Skool</title>
    <link rel="stylesheet" href="style.css" />

    <!-- Clerk SDK -->
    <script
      async
      crossorigin="anonymous"
      data-clerk-publishable-key="pk_test_Y3Jpc3Ata29pLTM4LmNsZXJrLmFjY291bnRzLmRldiQ"
      src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest"
    ></script>
  </head>

  <body>
    <header>
      <h1>üßæ Checkout</h1>
      <a href="index.html" class="checkout-btn">‚Üê Back to Store</a>
    </header>

    <section id="checkout-container" class="checkout-container"></section>

    <script>
      window.addEventListener("DOMContentLoaded", async () => {
        await window.Clerk.load();

        if (!Clerk.user) {
          alert("Please sign in to continue checkout.");
          window.location.href = "index.html";
          return;
        }

        const cart = JSON.parse(localStorage.getItem("cart")) || [];
        const container = document.getElementById("checkout-container");

        if (cart.length === 0) {
          container.innerHTML = `<h3>Your cart is empty üõí</h3>`;
          return;
        }

        let total = 0;
        container.innerHTML = cart
          .map((item) => {
            total += item.price;
            return `
              <div class="checkout-item">
                <img src="${item.image}" width="80" height="80" />
                <div>
                  <h3>${item.name}</h3>
                  <p>‚Çπ${item.price}</p>
                </div>
              </div>
            `;
          })
          .join("");

        container.innerHTML += `
          <hr />
          <h2>Total: ‚Çπ${total}</h2>
          <button onclick="placeOrder()" class="checkout-btn">Place Order ‚úÖ</button>
        `;

        window.placeOrder = () => {
          alert("üéâ Order placed successfully!");
          localStorage.removeItem("cart");
          window.location.href = "index.html";
        };
      });
    </script>
  </body>
</html>
