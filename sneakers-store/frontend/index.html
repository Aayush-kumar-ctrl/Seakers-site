<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Old Skool - Gentswear</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Open+Sans&display=swap"
      rel="stylesheet"
    /><head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sneakers Store</title>

  <!-- Clerk SDK -->
  <script
    async
    crossorigin="anonymous"
    data-clerk-publishable-key="pk_test_Y3Jpc3Ata29pLTM4LmNsZXJrLmFjY291bnRzLmRldiQ"
    src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest/dist/clerk.browser.js">
  </script>

  <script>
    window.addEventListener("load", async function () {
      await Clerk.load();

      if (Clerk.user) {
        document.getElementById("app").innerHTML = `
          <p>Welcome, ${Clerk.user.firstName || "User"}!</p>
          <button id="sign-out">Sign Out</button>
        `;
        document.getElementById("sign-out").addEventListener("click", () => Clerk.signOut());
      } else {
        document.getElementById("app").innerHTML = `
          <button id="sign-up">Sign Up</button>
          <button id="sign-in">Sign In</button>
        `;

        document.getElementById("sign-up").addEventListener("click", () => Clerk.openSignUp());
        document.getElementById("sign-in").addEventListener("click", () => Clerk.openSignIn());
      }
    });
  </script>
    <script
      async
      crossorigin="anonymous"
      data-clerk-publishable-key="pk_test_Y3Jpc3Ata29pLTM4LmNsZXJrLmFjY291bnRzLmRldiQ"
      src="https://cdn.jsdelivr.net/npm/@clerk/clerk-js@latest"
    ></script>
  </head>

  <body>
  <div id="app" style="padding:20px;"></div>
    <header class="hero">
      <nav class="navbar">
        <div class="logo">Old Skool</div>
        <ul class="nav-links">
          <li><a href="#">Home</a></li>
          <li><a href="#collection">Collection</a></li>
          <li><a href="#">Journal</a></li>
          <li><a href="#">Contact</a></li>
        </ul>

        <div id="auth-buttons">
          <button id="sign-in">Sign In</button>
          <button id="sign-out" style="display: none">Sign Out</button>
        </div>
      </nav>

      <div class="overlay"></div>
      <div class="hero-content">
        <h1>Old Skool Gentswear</h1>
        <p>Classic. Confident. Cultured.</p>
        <a href="#collection" class="btn">Explore the Collection</a>
      </div>
    </header>

    <!-- Product Collection -->
    <section class="collection" id="collection">
      <h2 class="section-title">Featured Collection</h2>
      <div id="products" class="products"></div>
    </section>

    <!-- Product Modal -->
    <div id="product-modal" class="modal" style="display: none">
      <div class="modal-content">
        <span class="close">&times;</span>
        <img id="modal-image" src="" alt="Product Image" />
        <h2 id="modal-name"></h2>
        <p id="modal-price"></p>
        <p id="modal-description"></p>
        <p id="modal-reviews">⭐ 4.5/5 (23 Reviews)</p>
        <button id="add-to-cart">Add to Cart</button>
      </div>
    </div>

    <footer class="footer">
      <p>&copy; 2025 Old Skool. All rights reserved.</p>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const clerk = new Clerk({ publishableKey: "pk_test_Y3Jpc3Ata29pLTM4LmNsZXJrLmFjY291bnRzLmRldiQ" });
        await clerk.load();

        const signInBtn = document.getElementById("sign-in");
        const signOutBtn = document.getElementById("sign-out");

        async function updateAuthUI() {
          const user = clerk.user;
          if (user) {
            signInBtn.style.display = "none";
            signOutBtn.style.display = "block";
          } else {
            signInBtn.style.display = "block";
            signOutBtn.style.display = "none";
          }
        }

        signInBtn.addEventListener("click", () => clerk.openSignIn());
        signOutBtn.addEventListener("click", () => clerk.signOut());
        updateAuthUI();

        // Fetch products
        const res = await fetch("http://localhost:5000/api/products");
        const products = await res.json();
        const productsContainer = document.getElementById("products");

        products.forEach((p) => {
          const card = document.createElement("div");
          card.className = "product-card";
          card.innerHTML = `
            <img src="${p.image}" alt="${p.name}" />
            <h3>${p.name}</h3>
            <p class="price">₹${p.price}</p>
          `;
          card.addEventListener("click", () => openModal(p));
          productsContainer.appendChild(card);
        });

        // Modal functionality
        const modal = document.getElementById("product-modal");
        const closeBtn = modal.querySelector(".close");

        function openModal(product) {
          modal.style.display = "flex";
          document.getElementById("modal-image").src = product.image;
          document.getElementById("modal-name").innerText = product.name;
          document.getElementById("modal-price").innerText = "₹" + product.price;
          document.getElementById("modal-description").innerText = product.description || "A classic addition to your wardrobe.";
          document.getElementById("add-to-cart").onclick = () => addToCart(product);
        }

        closeBtn.onclick = () => (modal.style.display = "none");
        window.onclick = (e) => {
          if (e.target == modal) modal.style.display = "none";
        };

        async function addToCart(product) {
          const user = clerk.user;
          if (!user) {
            alert("Please sign in first to add products to your cart.");
            return;
          }
          const userId = user.id;
          const res = await fetch("http://localhost:5000/api/cart", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ userId, productId: product._id }),
          });
          const data = await res.json();
          alert(data.message || "Added to cart!");
        }
      });
    </script>

    <style>
      /* Basic styling */
      body {
        font-family: "Open Sans", sans-serif;
        margin: 0;
        background: #fafafa;
      }
      .products {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        padding: 20px;
        max-width: 1200px;
        margin: auto;
      }
      .product-card {
        background: white;
        border-radius: 10px;
        overflow: hidden;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s;
      }
      .product-card:hover {
        transform: scale(1.03);
        cursor: pointer;
      }
      .product-card img {
        width: 100%;
        height: 250px;
        object-fit: cover;
      }
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        align-items: center;
        justify-content: center;
        z-index: 1000;
      }
      .modal-content {
        background: white;
        padding: 30px;
        border-radius: 10px;
        max-width: 500px;
        width: 90%;
        text-align: center;
        position: relative;
      }
      .close {
        position: absolute;
        right: 10px;
        top: 10px;
        font-size: 24px;
        cursor: pointer;
      }
      #add-to-cart {
        margin-top: 15px;
        padding: 10px 20px;
        background: black;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
    </style>
  </body>
</html>
